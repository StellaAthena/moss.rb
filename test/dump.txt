myth.zomato.tweeter.server;java.util.ArrayList;java.util.HashMap;java.util.List;java.util.Map;java.util.Set;org.apache.log4j.Logger;myth.zomato.tweeter.client.service.ListService;myth.zomato.tweeter.shared.TweeterList;com.google.appengine.api.datastore.DatastoreService;com.google.appengine.api.datastore.DatastoreServiceFactory;com.google.appengine.api.datastore.Entity;com.google.appengine.api.datastore.FetchOptions;com.google.appengine.api.datastore.Key;com.google.appengine.api.datastore.Query;com.google.gwt.user.server.rpc.RemoteServiceServlet;CodeRemoteServiceServletListService{List<TweeterList>listoflist=ArrayList<TweeterList>();DatastoreServicedatastore=DatastoreServiceFactory.getDatastoreService();@OverrideList<TweeterList>getList(){listoflist.clear();Queryquery=Query(ListParentKey.getKey());List<Entity>zomatolist=datastore.prepare(query).asList(FetchOptions.Builder.withDefaults());Map<String,Object>listmap;ArrayList<String>list;System.err.prln(zomatolist.size());(Entitye:zomatolist){listmap=e.getProperties();Set<String>listset=listmap.keySet();list=ArrayList(listset);TweeterListtweeterlist=TweeterList(e.getKind(),list);listoflist.add(tweeterlist);}listoflist;}@OverrideaddList(Stringlistname){Keylistkey=ListParentKey.getKey();Entitylistentity=Entity(listname,listkey);datastore.put(listentity);}@OverrideaddItem(Stringlistname,Stringitem){Queryquery=Query(listname,ListParentKey.getKey());Entityentity=datastore.prepare(query).asSingleEntity();entity.setProperty(item,"");datastore.put(entity);}@OverridedeleteItem(Stringlistname){Queryquery=Query(listname,ListParentKey.getKey());Entityentity=datastore.prepare(query).asSingleEntity();datastore.delete(entity.getKey());}@OverridedeleteIds(ArrayList<String>ids){Queryquery=Query(ListParentKey.getKey());List<Entity>zomatolist=datastore.prepare(query).asList(FetchOptions.Builder.withDefaults());Map<String,Object>listmap;(c=0;c<zomatolist.size();c++){listmap=zomatolist.get(c).getProperties();Set<String>listset=listmap.keySet();(listset.contains(ids.get(0))==false);{(Strings:ids){zomatolist.get(c).removeProperty(s);}datastore.put(zomatolist.get(c));}}}}
